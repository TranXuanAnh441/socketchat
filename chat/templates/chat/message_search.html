<html lang="ja"><head><meta charset="utf-8"></head>
  <body>
    <h1>Searched result</h1>
    
    <div id="messages">
        {% for message in messages %}
        <p> {{ message.date }}</p>
        <p>{{message.sender.username}} : {{ message.message}} </p>
        {% endfor %}
    </div>

    <script>
        var searchInput = {{ search }};
        window.onload = function(){
            var ancestor = document.getElementById('messages');
            var descendents = ancestor.getElementsByTagName('p');

            for (var i = 0; i < descendents.length; i++){
                descendents[i].innerHTML = descendents[i].innerHTML.replace(
                    new RegExp(searchInput + '(?!([^<]+)?<)', 'gi'),
                    '<b style="background-color:#ff0;font-size:100%">$&</b>'
                );
            }
        }


    </script>

  </body>
</html>